%data for New England Test case

disp('New England data')
%(bus#)( volt )( ang  )(  pgen )(  qgen )( pload )( qload )(gshunt)(bshunt)(bus type)
bus=[
   1   1.0116 0  0.0000   0.0000   1.0000   1.8400 0.00000 1.00000 3 99  -99 1.0   0     0;
   2   1.0165 0   0.0000   0.0000   0.0000  1.0000 0.00000 2.00000 3 99  -99 1.0   0     0;
   3   1.0172 0   0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99 -99  1.0  1.17  0.98;
   4   1.0067 1  0.0000   0.0000   2.3380   0.4000 0.00000 0.00000 3 99  -99 1.0   0     0;
   5   1.0057 2  0.0000   0.0000   2.2200   1.7600 0.00000 0.00000 3 99  -99 1.0   0     0;
   6   1.0322 1  0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99  -99 1.0   0     0;
  7   1.0235 2   0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99  -99 1.0   0     0;
  8   1.0201 1   0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99  -99 1.0   0     0;
  9   1.0072 0   0.0000   0.0000   0.0850   0.8800 0.00000 0.00000 3 99  -99 1.0   0     0;
  10   1.0207 2   0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99  -99 1.0   0     0;
  11   1.0181 2   0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99  -99 1.0   0     0;
  12   1.0194 2   0.0000   0.0000   3.2000   1.5300 0.00000 0.00000 3 99  -99 1.0   0     0;
  13   1.0346 2   0.0000   0.0000   3.2940   0.2300 0.00000 0.00000 3 99  -99 1.0   0     0;
  14   1.0065 1   0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99  -99 1.0   0     0;
  15   1.0043 1   0.0000   0.0000   1.5800   0.3000 0.00000 0.00000 3 99  -99 1.0   0     0;
  16   1.0209 1   0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99  -99 1.0   0     0;
  17   0.9914 1   0.0000   0.0000   1.8000   1.0300 0.00000 0.00000 3 99  -99 1.0   0     0;
  18   1.0037 0   0.0000   0.0000   2.7400   1.1500 0.00000 0.00000 3 99  -99 1.0   0     0;
  19   1.0009 0   0.0000   0.0000   0.0000   0.0000 0.00000 0.00000 3 99  -99 1.0   0     0;
  20   1.0059 0   0.0000   0.0000   2.4750   0.8460 0.00000 0.00000 3 99  -99 1.0   0     0;
  21   1.0099 0   0.0000   0.0000   1.0860   0.922 0.00000 0.00000 3 99  -99 1.0   0     0;
  22   1.00400  0   3.7293   0.7036   0.0920   0.0460 0.00000 0.00000 2  18   -15 1.0   0     0;
  23   0.9831  0   8.5000  0.7590   0.0000   0.0000 0.00000 0.00000 1  18   -15 1.0   0     0;
  24   0.9972  0   3.3200   1.0335   0.0000   0.0000 0.00000 0.00000 2  18   -15 1.0   0     0;
  25   1.0123  0   3.0800   0.6400   0.0000   1.0000 0.00000 0.00000 2  14   -13 1.0   0     0;
  26   1.0193  0   3.5000   0.0884   0.0000   0.0000 0.00000 0.00000 2  18   -15 1.0   0     0;
  27   1.00235  0   5.6000   0.9688   0.0000   0.0000 0.00000 0.00000 2  18   -15 1.0   0     0;
  ];

%b#1 b#2( res  )(  rea  )(charg )(tap )(phase)
line = [
   1   2 0.00080  0.01280 0.13420 0.0000 0   0    0    0;
   1  11 0.00080  0.01290 0.13820 0.0000 0   0    0    0;
   2   5 0.00080  0.01120 0.14760 0.0000 0   0    0    0;
   3   2 0.00020  0.00260 0.04340 0.0000 0   0    0    0;
   3   4 0.00060  0.00920 0.11300 0.0000 0   0    0    0;
   3  8 0.00070  0.00820 0.13890 0.0000 0   0    0    0;
   4   5 0.00040  0.00460 0.07800 0.0000 0   0    0    0;
   5   6 0.00230  0.03630 0.38040 0.0000 0   0    0    0;

  7  8 0.00040  0.00430 0.07290 0.0000 0   0    0    0;
  7  10 0.00040  0.00430 0.07290 0.0000 0   0    0    0;
  7  23 0.00000  0.02000 0.00000 1.0700 0   0    0    0;
  9  8 0.00160  0.04350 0.00000 1.0060 0   0    0    0;
  9  10 0.00160  0.04350 0.00000 1.0060 0   0    0    0;
  10  11 0.00090  0.01010 0.17230 0.0000 0   0    0    0;
  11  12 0.00180  0.02170 0.36600 0.0000 0   0    0    0;
  12  13 0.00090  0.00940 0.17100 0.0000 0   0    0    0;
  13  14 0.001 0.01 0.3 0.0000 0   0    0    0;
  13  16 0.00160  0.01950 0.30400 0.0000 0   0    0    0;
  13  18 0.00080  0.01350 0.25480 0.0000 0   0    0    0;
  13  21 0.00030  0.00590 0.06800 0.0000 0   0    0    0;
  14  15 0.00070  0.00820 0.13190 0.0000 0   0    0    0;
 
  16  24 0.00070  0.01420 0.00000 1.0700 0   0    0    0;
  16  17 0.00070  0.01380 0.00000 1.0600 0   0    0    0;
  17  25 0.00090  0.01800 0.00000 1.0090 0   0    0    0;
  18  19 0.00080  0.01400 0.25650 0.0000 0   0    0    0;
  19  20 0.00060  0.00960 0.18460 0.0000 0   0    0    0;
  19  26 0.00000  0.01430 0.00000 1.0250 0   0    0    0;
  20  21 0.00220  0.03500 0.36100 0.0000 0   0    0    0;
  20  27 0.00050  0.02720 0.00000 1.0000 0   0    0    0;
  
  22   3 0.00000  0.02500 0.00000 1.0000 0  1.2  0.8  0.05;];


mac_con = [
 
  1  22  1000.0 0.350 0.0270  2.950 0.697 0 6.560 0 2.820 0.697 0  1.500 0 3.030 0.000 0.00 22 0 0;
  2  23  1000.0 0.304 .00386  2.495 0.531 0 5.700 0 2.370 0.531 0  1.500 0 3.580 0.000 0.00 23 0 0;
  3  24  1000.0 0.295 .00222  2.620 0.436 0 5.690 0 2.580 0.436 0  1.500 0 2.860 0.000 0.00 24 0 0;
  4  25  1000.0 0.540 0.0014  6.700 1.320 0 5.400 0 6.200 1.320 0  0.440 0 2.600 0.000 0.00 25 0 0;
  5  26  1000.0 0.224 0.0615  2.540 0.500 0 7.300 0 2.410 0.500 0  0.400 0 3.480 0.000 0.00 26 0 0;
  6  27  1000.0 0.322 .00268  2.950 0.490 0 5.660 0 2.920 0.490 0  1.500 0 2.640 0.000 0.00 27 0 0;
];

exc_con =[

1   1  0  6.20 0.050  0.000 0.000 100   -100     0.63 0.410 3   0.66 4 0.88  0 0.06  0.500 
1   2  0  5.00 0.060  0.000 0.000 100   -100    -0.02 0.500 3   0.13 4 0.34  0 0.08  1.000 
1   3  0  5.00 0.060  0.000 0.000 100   -100    -0.05 0.500 3   0.08 4 0.31  0 0.08  1.000 
1   4  0 40.00 0.020  0.000 0.000 100  -100   -0.04 0.785 3   0.03 4 0.91  0 0.03  1.000 
1   5  0  5.00 0.020  0.000 0.000 100   -100     1.00 0.471 3   0.08 4 0.25  0 0.08  1.25
1   6  0 40.00 0.020  0.000 0.000 100 -100   1.00 0.730 3   0.03 4 0.74  0 0.03  1.000 
];


%Switching file defines the simulation control
% row 1 col1  simulation start time (s) (cols 2 to 6 zeros)
%       col7  initial time step (s)
% row 2 col1  fault application time (s)
%       col2  bus number at which fault is applied
%       col3  bus number defining far end of faulted line
%       col4  zero sequence impedance in pu on system base
%       col5  negative sequence impedance in pu on system base
%       col6  type of fault  - 0 three phase
%                            - 1 line to ground
%                            - 2 line-to-line to ground
%                            - 3 line-to-line
%                            - 4 loss of line with no fault
%                            - 5 loss of load at bus
%       col7  time step for fault period (s)
% row 3 col1  near end fault clearing time (s) (cols 2 to 6 zeros)
%       col7  time step for second part of fault (s)
% row 4 col1  far end fault clearing time (s) (cols 2 to 6 zeros)
%       col7  time step for fault cleared simulation (s)
% row 5 col1  time to change step length (s)
%       col7  time step (s)
%
%
%
% row n col1 finishing time (s)  (n indicates that intermediate rows may be inserted)
%pss_con = [];
pss_con = [... 
     1   1    48.86  10  0.36  0.01  0.445  0.0159 0.01 -0.05 ;   
     1   2    28.66  10  0.72  0.02  0.65  0.037 0.01 -0.05 ;
     1   3    42.93  10  0.7  0.0426  0.5638  0.0403 0.02 -0.05 ;
     1   4    49.43  10  0.1211  0.06  0.3034  0.02228 0.02 -0.05 ;
     1   5    48.45  10  0.6944  0.0156  1.4158  0.0793 0.02 -0.05 ;
     1   6    1.24  10  0.3564  0.0275  0.5639  0.1211 0.02 -0.05 ;
     ];
sw_con = [...
0    0    0    0    0    0    0.01;%sets intitial time step
0.5  16    17    0    0    6    0.01; %apply three phase fault at bus 3 line 3-4
0.6 0    0    0    0    0    0.01; %clear fault at bus 3
0.18 0    0    0    0    0    0.01; %clear remote end
0.50 0    0    0    0    0    0.02; % increase time step 
1.0  0    0    0    0    0    0.02; % increase time step
50.0  0    0    0    0    0    0]; % end simulation



%ibus_con = zeros(length(mac_con(:,1)),1);
%ibus_con(10) = 1;